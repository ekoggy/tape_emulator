# Описание проекта
Данный проект создан в целях разработки алгоритма внешней сортировки для любых устройств хранения. В представленной версии в качестве внешнего носителя используется магнитная лента, а точнее её эмулятор в виде файла и интерфейса взаимодествия с ним.

# Устройство хранения
Магнитная лента на данный момент является более дешевым и долговечным конкуретом HDD и SSD. Кроме того стоит отметить, что емкость которую возможно разместить на подобном носители несравнимо выше, чем у аналогов. Важным недостатком данной системы является лишь невозможность произвольного чтения. То есть, если необходимо прочитать предыдущую запись, необходимо промотать ленту до начала и найти нужную ячейку.

## Интерфейс работы с устройством хранения
Ленты представляют собой символьные устройства и в linux с ними можно работать поредством общих системных вызовов read(2) и write(2) с буффером соответствующего размера. 

## Описание метода эмуляции
Для эмуляции работы с магнитной лентой был выбран формат записи в файл вида
```
12
33
412
1241
...
```
При этом был создан класс, имитирующий работу с лентой посреством установки задержек для чтения, записи, смещения и перемотки. длительности всех задержек указываются в файле ``//etc/tape_emulator.conf``в следующем виде:
```
read_delay: 1
write_delay: 1
shift_delay: 1
rewind_delay: 1
```
# Описание разработанного решения

## Входные и выходные данные
На входе программа получает две строки, обозначающие пути к входному и выходному файлу. 
## Общий алгоритм
В начале работы из входного файла последовательно копируется информация в промежуочный файл-ленту. В конце выполнения программа записывает результат в выходной файл.
## Класс работы с устройством хранения
Описание методов работы с псевдо-лентой:) присутствует в TapeEmulator. Здесь описаны функции get, write, shift и rewind, которые реализую всю эмуляцию и используют считанные из конфигурации задержки.
## Класс работы с сортировкой данных
Сортировка описана в классе TapeSorter и состоит из двух частей: разделения и слияния. 
При разделении один файл разбивается на два, при этом в каждый файл последовательно записываются возрастающие цепочки.
_Пример(знаком "|" обозначен конец возрастающей последовательности):_
```
src_file: 1 2 8 | 7 8 9 | 0 3 21 | 0 1 14 15 | 12 24 |
dst_file1: 1 2 8 | 0 3 21 | 12 24 |
dst_file2: 7 8 9 | 0 1 14 15 |
```
Следующим этапом проводится слияние - последовательная запись элементов обоих файлов по возрастанию в новый файл. Для этого из каждого файла счтывается по одному элементу и производится сравнение, наименьший элемент записывается, второй элемент ожидает, пока он не станет наименьшим или не наступит конец первого файла.
_Пример(знаком "|" обозначен конец возрастающей последовательности):_
```
src_file1: 1 2 8 | 0 3 21 | 12 24 |
src_file2: 7 8 9 | 0 1 14 15 |
dst_file:  1 2 7 8 | 0 3 8 9 | 0 1 14 15 21 | 12 24
```
Как видно вместо пяти возрастающих последовательностей в начальнойй выборке после слияние имеем четыре. Алгоритм итеративно выполняет разделение и слияние до тех пор, пока не будет возможности произвести разделение, то есть будет присутствовать лишь одна возрастающая последовательность.
## Временные файлы
В программе используется 3 временных файла: /tmp/tmp_tape_1, /tmp/tmp_tape_2, /tmp/tmp_tape_3.

# Установка и настройка
Для создания испольняемого файла рекомендуется использовать Makefile, предоставленный в репозитории.
Для настройки задержек не требуется перекомпиляция.